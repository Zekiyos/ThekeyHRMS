<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<style type="text/css">
	table,th,td{
	/*background-color:#CCCCCC;*/
			background-color:#CCE6FF;
	border:solid 1px;
	border-color:#F90;
	border-collapse: collapse;
	font-size: 90%;
}
	html{font-family:Arial,Helvetica,Sans-Serif;font-size:20px}
	body{
	background-color:#FCFCFC;
}
	table.month{cellspacing:0;cellpadding:0}
	body{
		font-family: Verdana, Arial, Helvetica, sans-serif;
		font-weight: normal;
		font-size: 80%;
		}
	#yin{
	background-color:#EBEBEB;
}
	.eth{
	color:#30F;
		}

	.gc{
	color:#093;		/*color:blue;*/
		}
	td#today{background-color:#ffff00;
			font-weight:bold;
			border:solid 4px;border-color:#FF0000;border-collapse: collapse;
			}	
</style>
<script language="JavaScript">
	//offset is # days between 1/1/1970 (UNIX time) and the calendar beginning year
	//Exampe with 1753 beginning year
	//1970-1753=217 years 
	// 217 * 365 = 79205 days
	// add leap year days between 1753 and 1970 = 52 , 79205 + 52 = 79257
	// the remaining 115 days account for the number of days since Meskerem 1 
	// to January 1 of 1953 (disregarding the year) to align jan 1 to an 
	// Ethiopian date (Tahsas xx).
	// It happens that in 1953, Jan 1 = Tahsas 25. That is Meskerem, Tikimt, Hidar 
	// with 30 days each equal 90 plus 25 (Tahsas) equals 115
	// the final offset equals 79372 = 79257 (from prev calc) + 115 
	OFFSET=79372,DAY=1000*60*60*24
	var EYear,EMonth,EDate,GC,browser,ver
	var today=new Date()
	var GMonths="January,February,March,April,May,June,July,August,September,October,November,December".split(",")
	var	EMonths=["\u1218\u1235\u12a8\u1228\u121d","\u1325\u1245\u121d\u1275",
				"\u1285\u12f3\u122d","\u1273\u1285\u1223\u1225",
				"\u1325\u122d","\u12e8\u12ab\u1272\u1275",
				"\u1218\u130b\u1262\u1275","\u121a\u12eb\u12dd\u12eb",
				"\u130d\u1295\u1266\u1275","\u1230\u1294",
				"\u1210\u121d\u120c","\u1290\u1210\u1234",
				"\u1333\u1309\u121c"]
	var DOWs="Su,Mo,Tu,We,Th,Fr,Sa".split(",")
	
	function initLoad(){
		document.theForm.year.value=today.getFullYear()
		getCalendar();
		focusInputField()
		}

	function focusInputField(){
		browser=getBrowserName()
		if (browser=="N" && ver<5)
			alert ("This page is best viewed with Internet Explorer version 4 and later\n"+
					"and Netscape version 5 or later!")
		document.theForm.year.focus()
		}

	function getObj(id){
		d=document;
		id=d.all?d.all[id]:d.getElementById(id);
		return id
		}
		
	function getBrowserName(){
		ver=(navigator.appVersion).substring(0,1)
		return ((navigator.appName).indexOf("Explorer")==-1?"N":"E")
		}

	function isValid(yr){
		return (yr>1752 && yr<10000)
		}
		
	function getECDays(dt){
		GC=new Date(dt)
		UTCVal=Date.UTC(GC.getFullYear(),GC.getMonth(),GC.getDate())
		return OFFSET+(UTCVal/DAY)
		}
		
	function ECDate(dt){
		days=getECDays(dt)
		mark=0
		EYear=1745
		while (mark==0){
			if (EYear % 4 ==3){
				if (days>=366){
					days-=366
					EYear++
				    }
   				else mark=1
				}
			else{
   				if (days>=365){
    	 				days-=365
					EYear++
					}
	   			else mark=1
   				}
			}
		if (days==0){
			EYear-=1
			EMonth=13
			EDate=5 + ((EYear % 4 ==3)?1:0)
			}
		else{
			EMonth = Math.ceil(days / 30)
			if (days % 30 ==0)
				EDate = 30
			else EDate=days % 30
			}
		return EMonth + "/"+ EDate + "/" + EYear
		}
	
	function getKeyCode(e){
		if (document.theForm.year.value.match(/^\d{4}$/g)!=null)
			getCalendar();
		}		

	function getGDays(m,y){
		if (m==4 || m==6 || m==9|| m==11)
			return 30
		if (m==2){
			if (y % 100==0 && y % 400!=0)
				return 28
			if (y%4==0)
				return 29
			return 28
			}		
		return 31	
		}

	function getCalendar(){
		if (!isValid(document.theForm.year.value)){
			alert ("Gregorian year cannot be earlier than 1753!")
			return false
			}
		yr=document.theForm.year.value
		out=""
		for (m=1;m<13;m++)
			out+=getMonCal(m,yr)
		getObj("calendar").innerHTML=out	
		layoutCalendar()
		}
	
	function layoutCalendar(){
		cur_left=15
		cur_top=50
		width=350
		height=160
		spacing=10
		max_height=0
		for (var i=1;i<13;i++){
			cur_mon=getObj("m_"+i)
			cur_mon.style.position="absolute"
			cur_mon.style.top=cur_top+"px"
			cur_mon.style.left=cur_left+"px"
			max_height=Math.max(max_height,cur_mon.clientHeight)
			cur_left+=width+spacing	
			if (i % 3==0){
				cur_top+=spacing+max_height
				max_height=0
				cur_left=15
				}
			}
		}

	function itemExists(arr,item){ 
		if (arr==null)
			return 0
		var retval=0
		idx=0
		while (retval==0 && idx<arr.length){
			retval=arr[idx]==item
			idx++
			}
		return retval	
		}

	function getMonCal(m,y){
		GDays=getGDays(m,y)
		var retval="<tr>"
		var emonths=new Array()
		var eyears=new Array()
		for (var w=0;w<DOWs.length;w++)
			retval+="<th>"+DOWs[w]+"</th>"
		retval+="</tr>"
		for (var d=1;d<=GDays;d++){
			gc=new Date(m+"/"+d+"/"+y)
			dow=DOWs[gc.getDay()]
			if (d==1)
				retval=advanceDow(retval,gc.getDay())
			tmp=ECDate(gc).split("/")
			if (emonths.length==0)
				emonths[0]=tmp[0]
			else if (!itemExists(emonths,tmp[0]))
				emonths[emonths.length]=tmp[0]
			if (eyears.length==0)
				eyears[0]=tmp[2]
			else if (!itemExists(eyears,tmp[2]))
				eyears[eyears.length]=tmp[2]
			if(gc.getDay()==0)
				retval+="</tr>\n<tr>"
			if (y==today.getFullYear() && m==1+today.getMonth() && d==today.getDate())
				retval+="<td id='today'><span class=gc>"+d+"</span>/<span class=eth>"+tmp[1]+"</span></td>"
			else	
				retval+="<td><span class=gc>"+d+"</span>/<span class=eth>"+tmp[1]+"</span></td>"
			}
		retval=advanceToSa(retval,gc.getDay())
		
		if (eyears.length==2)
			emy=EMonths[emonths[0]-1]+"/"+EMonths[emonths[1]-1]+" "+eyears[0]+"/"+EMonths[emonths[2]-1]+" "+eyears[1]
		else
			emy=EMonths[emonths[0]-1]+"/"+EMonths[emonths[1]-1]+" "+eyears[0]
		my="<span class=gc>"+GMonths[m-1]+" "+y+"</span><br/><span class=eth>"+emy+"</span>"
		
		return "<div id='m_"+m+"'>"+
			"<table class='month' cols='7'><tr><th colspan='7'>"+my+"</th></tr>"+retval+
			"</table>"+
			"</div>"
		}
		
	function advanceDow(str,dow){
		str+="<tr>"
		for (var i=1;i<=dow;i++)
			str+="<td></td>"
		return str	
		}
		
	function advanceToSa(str,dow){
		for (var i=dow;i<7;i++)
			str+="<td></td>"
		return str	
		}
		
</script>
</head>
<body onload=initLoad()>

<table width="774" height="30" border=0 cellpadding=1 cellspacing=0 cols=2>
<form name="theForm">
<tr><td width="329" height="33" id="yin"><font  size="5" color="#FF9900" ><b>Thekey</font><font color="#999999" size="5" >HRMS</b></font><font color="#999999" size="2" >  The key is yours!! </font></td><td width="200" id="yin" size="2">Enter a Gregorian Year </td><td width=122>	<input type=text name="year" size=10 maxlength=4 onKeyUp="return getKeyCode(event)"></td><td width="113" align="right"><img src="../img logo & icons/thekey soft.jpg" height="36" width="111"  align="absmiddle" ></td>
</tr>
</form>
</table>
<br/>
<br/>
<br/>
<div id="calendar"></div>
</body>
</html>
